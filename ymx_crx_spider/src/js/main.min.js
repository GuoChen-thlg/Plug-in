const API_URL=" https://192.168.1.153:443/dev-api";$.cxDialog.defaults.baseClass="ios",$.extend({log:function(...data){}});let tipsInfo={side:3,color:"#FFF",bg:"#FF00FF",time:"2"};function findAllAsin(){let asinlist=[],ajax_asin_list=[],divs,product_iist_asin=$("div[data-asin]").map((i,o)=>{if(""!==o.dataset.asin&&10==o.dataset.asin.length)return o.dataset.asin});return document.querySelectorAll("div[data-a-carousel-options]").forEach(o=>{if(JSON.parse(o.dataset.aCarouselOptions).ajax){let arr=JSON.parse(o.dataset.aCarouselOptions).ajax.id_list;ajax_asin_list=[...ajax_asin_list,...arr]}}),ajax_asin_list=ajax_asin_list.map(o=>o.substr(0,10)),asinlist=new Set([...product_iist_asin,...ajax_asin_list]),[...asinlist]}function renderTable(asinlist){$.log(asinlist.toString());const zh_ch={sProcessing:'<div class="spinner-border spinner-border-sm mr-2" role="status"> <span class="sr-only">Loading...</span> </div>å¤„ç†ä¸­...',sLengthMenu:"æ˜¾ç¤º _MENU_ é¡¹ç»“æœ",sZeroRecords:"æ²¡æœ‰åŒ¹é…ç»“æœ",sInfo:"æ˜¾ç¤ºç¬¬ _START_ è‡³ _END_ é¡¹ç»“æœï¼Œå…± _TOTAL_ é¡¹",sInfoEmpty:"æ˜¾ç¤ºç¬¬ 0 è‡³ 0 é¡¹ç»“æœï¼Œå…± 0 é¡¹",sInfoFiltered:"(ç”± _MAX_ é¡¹ç»“æœè¿‡æ»¤)",sInfoPostFix:"",sSearch:"æœç´¢:",sUrl:"",sEmptyTable:"è¡¨ä¸­æ•°æ®ä¸ºç©º",sLoadingRecords:'<div class="spinner-border spinner-border-sm mr-2" role="status"> <span class="sr-only">Loading...</span> </div>è½½å…¥ä¸­...',sInfoThousands:",",oPaginate:{sFirst:"é¦–é¡µ",sPrevious:"ä¸Šé¡µ",sNext:"ä¸‹é¡µ",sLast:"æœ«é¡µ"},oAria:{sSortAscending:": ä»¥å‡åºæ’åˆ—æ­¤åˆ—",sSortDescending:": ä»¥é™åºæ’åˆ—æ­¤åˆ—"}},columns=[{title:"æ˜¯å¦è¿½è¸ª",data:"asin",orderable:!1,render:(data,type,row)=>`<input type="checkbox" data-asin=${data} checked class=" product_watch d-block mx-auto">`},{title:"äº§å“SKU",data:"asin"},{title:"äº§å“åç§°",data:"name",render:(data,type,row)=>`<span class="omit" title="${data}">${data}</span>`},{title:"é¦–å›¾",data:"img_url",render:(data,type,row)=>`<img class="product_img" src='${data}'/> <span style="display:none">${data}</span>`},{title:"äº§å“æ ‡é¢˜",data:"title",render:(data,type,row)=>`<span class="omit" title="${data}">${data}</span>`},{title:"äº§å“ä»·æ ¼ ",data:"price"},{title:"æ’å",data:"bsn"},{title:"èŠ‚ç‚¹æ’å",data:"node_ranking"},{title:"äº§å“è¯„åˆ†",data:"reviews_rating"},{title:"äº§å“è¯„è®ºæ•°é‡",data:"reviews_count"},{title:"é—®ç­”æ•°",data:"q_a"},{title:"å“ç‰Œå",data:"brand"},{title:"å–å®¶",data:"seller_Name"},{title:"æ‰€å±å¤§ç±»åˆ«",data:"b_categroy"},{title:"æ‰€å±å°ç±»åˆ«",data:"s_categroy"},{title:"ä¸Šæ¶æ—¶é—´",data:"launche_Time"},{title:"æè¿°",data:"descr",render:(data,type,row)=>`<span class="omit" title="${data}">${data}</span>`},{title:"äº§å“å˜ä½“",data:"variation_asins",render:(data,type,row)=>`<span class="omit" title="${data}">${data}</span>`},{title:"çˆ¶çº§ASIN",data:"parernt_asin"},{title:"åº“å­˜",data:"stock"},{title:"å–å®¶æ•°é‡",data:"num_sellers"},{title:"é…é€æ–¹å¼",data:"delivery"},{title:"è®°å½•æ—¶é—´",data:"crawl_time"}],table=$("#thlg_table_data").DataTable({language:zh_ch,autoWidth:!0,scrollX:!0,scrollY:"400px",colReorder:!0,fixedHeader:!0,fixedColumns:!1,lengthMenu:[[10,50,100,500,-1],[10,50,100,500,"All"]],dom:"<'d-inline-block px-2'>Blfrtip",buttons:[{extend:"copy",text:"ğŸ“‹COPY"},{extend:"excel",text:"EXCEL",className:" btn-success",charset:"UTF-8",title:`äº§å“ä¿¡æ¯${(new Date).toLocaleDateString()}${(new Date).toLocaleTimeString()}`,exportOptions:{columns:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22]}},{extend:"csv",text:"CSV",className:" btn-info",bom:!0,title:`äº§å“ä¿¡æ¯${(new Date).toLocaleDateString()}${(new Date).toLocaleTimeString()}`,exportOptions:{columns:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22]}}],columnDefs:[{targets:[0,1,2,3,4,11,12,13,14,16,17,18,21],orderable:!1}],ajax:{type:"GET",url:`${API_URL}/custom/user/amzproductList/${asinlist.toString()}`,headers:{"Content-Type":"application/json; charset=utf-8"},dataSrc:"amzProducts",error:function(XMLHttpRequest,errorinfo,error){$.cxDialog({title:"æç¤º",info:"è¯¥æ¬¾äº§å“æ•°æ®ç»´æŠ¤ä¸­...",okText:"âœ”",ok:()=>{close()}})}},columns:columns,initComplete:function(){$("input:checkbox").click((function(){let data={checked:this.checked,asin:this.attributes["data-asin"].value};console.log(data)}))}})}function eventBinding(){let app_root_style=null;$("#close").on("click",close),$(".full-screen-box").on("click",()=>{"block"===$(".full-screen-box>.full").css("display")?(app_root_style=$("#app-root").attr("style"),$("#app-root").css({width:"100%",height:"100%",top:"0",left:"0"}),$(".full-screen-box>.full").css("display","none"),$(".full-screen-box>.small").css("display","block")):($("#app-root").attr("style",app_root_style),$(".full-screen-box>.full").css("display","block"),$(".full-screen-box>.small").css("display","none"))}),$('button[type="button"].quit').on("click",()=>{$.cxDialog({title:"æç¤º",info:"ç¡®è®¤é€€å‡ºè¯¥è´¦å·å—â“",okText:"âœ”",ok:function(){close(),$.removeCookie("token",{path:"/"})},noText:"âŒ",no:()=>{}})}),$('button[type="button"].login').on("click",()=>{let login_user={u_name:$("#login_admin").val().trim(),u_password:$("#login_password").val().trim()};""==login_user.u_name?$("#login_admin").tips({...tipsInfo,msg:"è¯·å¡«å†™è´¦å·"}).focus():""==login_user.u_password?$("#login_password").tips({...tipsInfo,msg:"è¯·å¡«å†™å¯†ç "}).focus():login(login_user)}),$(".register").on("click",(function(e){return e.preventDefault(),open($(".register")[0].href),!1}))}function login(user){$(".popup_animation").css("display","block"),$.ajax({type:"POST",url:`${API_URL}/custom/user/loginCus`,headers:{"Content-Type":"application/json; charset=utf-8"},data:JSON.stringify({...user}),dataType:"json",success:function(response){"200"===response.status?($.cookie("token",user.u_name,{expires:1,path:"/"}),$("#user_name").text(user.u_name),$(".popup_animation").css("display","none"),$.log("ç™»å½•æˆåŠŸï¼Œæ¸²æŸ“æ•°æ®è¡¨ï¼Œæ˜¾ç¤ºæ•°æ®è¡¨"),renderTable([$("#ASIN").val(),...findAllAsin()]),$(".main_wrap.login_outer_box").css("display","none"),$(".main_wrap.data_show_box").css("display","block"),$(".popup_animation").css("display","none")):$.cxDialog({title:"æç¤º",info:"è´¦å·æˆ–å¯†ç ä¸æ­£ç¡®ï¼Œç™»å½•å¤±è´¥",okText:"âœ”",ok:()=>{$(".popup_animation").css("display","none")}})},error:function(xhr,status,error){let info=null;switch(status){case"error":info="ç™»å½•å¤±è´¥ğŸ˜…ï¼Œè¯·ç¨åé‡è¯•ã€‚";break;case"timeout":info="è¯·æ±‚è¶…æ—¶ğŸ˜…ï¼Œè¯·ç¨åé‡è¯•ã€‚";break;default:info="é”™è¯¯ğŸ˜…ï¼Œè¯·ç¨åé‡è¯•ã€‚"}$(".popup_animation").css("display","none"),$.cxDialog({title:"æç¤º",info:info,okText:"âœ”",ok:()=>{}}),$.log(error)}})}function verifyLogin(callback){$.log("åˆ¤æ–­cookie"),$.cookie("token")&&($("#user_name").text($.cookie("token")),$.log("å·²ç™»å½•ï¼Œæ‰§è¡Œ verifyLogin å›è°ƒæ–¹æ³•ï¼Œæ˜¾ç¤ºæ•°æ®è¡¨"),$(".main_wrap.login_outer_box").css("display","none"),$(".main_wrap.data_show_box").css("display","block"),callback())}function close(){const child=document.querySelector("#app-root");if(child){const parentnode=child.parentNode;parentnode.removeChild(child)}}function floatingWindow(callback){if(0==findAllAsin().length)return void $.cxDialog({title:"æç¤º",info:"è¯·åœ¨ äº§å“è¯¦æƒ…/äº§å“åˆ—è¡¨ é¡µæ‰“å¼€",okText:"âœ”",ok:()=>{}});let html='\n\t<div class="title">äº§å“ä¿¡æ¯</div>\n\t<div class="full-screen-box">\n\t<svg t="1598063281831" class="icon full" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3328" width="20" height="20"><path d="M641.750109 384.100028l205.227128-204.519-0.704035 115.89966c-0.282433 9.611915 7.489578 18.09103 17.101493 17.808598l12.297071 0c9.611915-0.283456 17.667382-5.936199 17.808598-15.689331l0.565888-172.57752c0-0.14224 0.282433-9.187243 0.282433-9.187243 0.14224-4.804423-0.99056-9.187243-4.100388-12.297071-3.109828-3.109828-7.347339-5.086855-12.297071-4.946662l-8.763594 0.14224c-0.141216 0-0.278339 0-0.420579 0.14224L697.581696 98.166787c-9.611915 0.283456-17.667382 8.200776-17.808598 17.950837l0 12.297071c1.416256 11.44875 10.458189 18.092054 20.070104 17.808598l112.789832 0.283456-204.66124 203.814965c-9.329483 9.329483-9.329483 24.449855 0 33.778314 9.329483 9.470699 24.452925 9.470699 33.782408 0L641.750109 384.100028zM383.095141 576.889893 177.726797 780.705881l0.707105-115.338888c0.283456-9.607822-7.492648-18.086937-17.104563-17.808598l-13.001105 0c-9.611915 0.283456-17.667382 5.937223-17.808598 15.690354l-0.565888 172.718737c0 0.14224-0.282433 9.187243-0.282433 9.187243-0.14224 4.808516 0.99056 9.187243 4.096295 12.297071 3.109828 3.109828 7.351432 5.086855 12.297071 4.946662l8.762571-0.14224c0.14224 0 0.283456 0 0.425695-0.14224l171.873486 0.708128c9.607822-0.283456 17.667382-8.196683 17.808598-17.950837L344.93503 832.575226c-1.415232-11.44875-10.461259-18.092054-20.074198-17.808598L212.069977 814.483172 416.59 610.671277c9.329483-9.329483 9.329483-24.453948 0-33.782408C407.40685 567.41817 392.424624 567.41817 383.095141 576.889893L383.095141 576.889893zM894.047276 835.967486l-0.424672-172.718737c-0.283456-9.612938-8.200776-15.406898-17.809621-15.690354l-12.296047 0c-9.612938-0.278339-17.243733 8.200776-17.105586 17.808598l0.708128 115.903753L641.750109 576.889893c-9.329483-9.329483-24.452925-9.329483-33.782408 0-9.325389 9.328459-9.325389 24.452925 0 33.782408L812.490795 814.483172l-112.789832 0.283456c-9.611915-0.283456-18.515702 6.502088-20.073174 17.808598l0 12.297071c0.282433 9.611915 8.200776 17.667382 17.808598 17.950837l171.166381-0.708128c0.141216 0 0.282433 0.14224 0.424672 0.14224l8.763594 0.14224c4.803399 0.141216 9.187243-1.694595 12.296047-4.946662 3.109828-3.109828 4.238534-7.488555 4.097318-12.297071 0 0-0.14224-9.046027-0.14224-9.187243L894.047276 835.968509zM212.216309 146.506748l112.789832-0.283456c9.607822 0.283456 18.512632-6.502088 20.070104-17.808598L345.076246 116.116601c-0.283456-9.611915-8.196683-17.667382-17.808598-17.950837l-172.011632 0.708128c-0.14224 0-0.283456-0.14224-0.425695-0.14224l-8.761548-0.14224c-4.808516-0.141216-9.187243 1.694595-12.297071 4.946662-3.109828 3.109828-4.242627 7.488555-4.096295 12.297071 0 0 0.282433 9.046027 0.282433 9.187243l0.420579 172.718737c0.14224 9.608845 8.200776 15.406898 17.808598 15.686261l13.005198 0c9.611915 0.282433 17.242709-8.196683 17.10047-17.808598l-0.564865-115.334795 205.231221 203.958228c9.324366 9.329483 24.448832 9.329483 33.777291 0 9.329483-9.329483 9.329483-24.452925 0-33.782408L212.216309 146.506748 212.216309 146.506748zM212.216309 146.506748" p-id="3329"></path></svg>\n\t<svg t="1598064061108" class="icon small" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3509" width="20" height="20"><path d="M 669.867 640 h 76.8 c 12.8 0 21.3333 -8.53333 21.3333 -21.3333 s -8.53333 -21.3333 -21.3333 -21.3333 h -128 c -12.8 0 -21.3333 8.53333 -21.3333 21.3333 v 128 c 0 12.8 8.53333 21.3333 21.3333 21.3333 s 21.3333 -8.53333 21.3333 -21.3333 v -76.8 l 132.267 132.267 c 4.26667 4.26667 8.53333 4.26667 17.0667 4.26667 s 12.8 0 17.0667 -4.26667 c 8.53333 -8.53333 8.53333 -21.3333 0 -29.8667 L 669.867 640 Z M 405.333 597.333 h -128 c -12.8 0 -21.3333 8.53333 -21.3333 21.3333 s 8.53333 21.3333 21.3333 21.3333 h 76.8 l -132.267 132.267 c -8.53333 8.53333 -8.53333 21.3333 0 29.8667 c 0 8.53333 8.53333 8.53333 12.8 8.53333 s 12.8 0 17.0667 -4.26667 L 384 669.867 v 76.8 c 0 12.8 8.53333 21.3333 21.3333 21.3333 s 21.3333 -8.53333 21.3333 -21.3333 v -128 c 0 -12.8 -8.53333 -21.3333 -21.3333 -21.3333 Z M 789.333 213.333 c -4.26667 0 -12.8 0 -17.0667 4.26667 L 640 354.133 V 277.333 c 0 -12.8 -8.53333 -21.3333 -21.3333 -21.3333 s -21.3333 8.53333 -21.3333 21.3333 v 128 c 0 12.8 8.53333 21.3333 21.3333 21.3333 h 128 c 12.8 0 21.3333 -8.53333 21.3333 -21.3333 s -8.53333 -21.3333 -21.3333 -21.3333 h -76.8 l 132.267 -132.267 c 8.53333 -8.53333 8.53333 -21.3333 0 -29.8667 c 0 -8.53333 -8.53333 -8.53333 -12.8 -8.53333 Z M 405.333 256 c -12.8 0 -21.3333 8.53333 -21.3333 21.3333 v 76.8 L 251.733 217.6 C 247.467 213.333 238.933 213.333 234.667 213.333 s -12.8 0 -17.0667 4.26667 c -4.26667 8.53333 -4.26667 25.6 0 34.1333 L 354.133 384 H 277.333 c -12.8 0 -21.3333 8.53333 -21.3333 21.3333 s 8.53333 21.3333 21.3333 21.3333 h 128 c 12.8 0 21.3333 -8.53333 21.3333 -21.3333 v -128 c 0 -12.8 -8.53333 -21.3333 -21.3333 -21.3333 Z" p-id="3510"></path></svg>\n\t</div>\n    <div class="_close" title="å…³é—­" id="close">X</div>\n    <main class="main_wrap login_outer_box ">\n    <div class="login_info_box mx-auto">\n        <form class="form  my-5 clearfix ">\n            <h3 class=" text-center ">ç™»å½•</h3>\n            <div class="form-group">\n                <label for="admin">è´¦æˆ·:</label>\n                <input type="text" class="form-control" id="login_admin" placeholder="è¯·è¾“å…¥è´¦å·" />\n            </div>\n            <div class="form-group">\n                <label for="password">å¯†ç :</label>\n                <input type="password" class="form-control" id="login_password" placeholder="è¯·è¾“å…¥å¯†ç " />\n            </div>\n            <div class="form-group lg_remember d-flex align-items-center justify-content-between">\n                <span> æ²¡æœ‰è´¦å·â“<a class="register text-danger text-decoration-none" href="http://192.168.1.13:8081/#/register">å‰å¾€æ³¨å†Œ\n                    </a></span>\n               \x3c!--  <ul class="d-flex float-right ">\n                         <li class="btn wxlogin"><img src="https://open.weixin.qq.com/zh_CN/htmledition/res/assets/res-design-download/icon24_wx_button.png" /></li>\n                     </ul> --\x3e\n            </div>\n            <button type="button" class="btn btn-success login w-75 mx-auto d-block ">ç™»å½•</button>\n        </form>\n    </div>\n    <div class="wx_login_box mx-auto text-center">\n        <button type="button" class=" position-absolute close p-3" aria-label="å…³é—­"> <span\n                aria-hidden="true">&times;</span> </button>\n        <div id="wxlogin" class="d-inline-block mx-auto mt-5">\n        </div>\n    </div>\n    <div class="popup_animation">\n        <div class="spinner-border mr-2" role="status">\n            <span class="sr-only">Loading...</span>\n        </div>\n    </div>\n</main>\n<main class="main_wrap data_show_box data_list p-3">\n    <div>\n    <span id="user_name"></span> <button type="button" class="btn quit  mb-2 float-right ">é€€å‡º</button>\n    </div>\n    <table cellpadding="0" cellspacing="0" class=" " id="thlg_table_data"></table>\n</main>';const app=document.createElement("div");app.id="app-root",app.innerHTML=html,$.log("è¿½åŠ  #app-root"),document.querySelector("body").appendChild(app),$("#app-root").bg_move({move:".title",size:12}),$.log("ç»‘å®šæŒ‰é’®äº‹ä»¶"),eventBinding(),$.log("#app-root æ¸²æŸ“æˆåŠŸï¼Œæ‰§è¡Œå›è°ƒ"),callback()}let tabUrl=$(location)[0].href;document.addEventListener("DOMContentLoaded",(function(){$("#twister li").click((function(){""!==$(this)[0].dataset.dpUrl&&(tabUrl=`${$(location)[0].origin}${$(this)[0].dataset.dpUrl}`)}))})),chrome.runtime.onMessage.addListener((function(request,sender,sendResponse){switch(request.type){case"OPEN":$.log("åˆ¤æ–­æ˜¯å¦å­˜åœ¨#app-root"),document.querySelector("#app-root")||($.log("å¼€å§‹æ¸²æŸ“#app-root"),$(()=>{floatingWindow(()=>{$.log("åˆ¤æ–­ç™»å½•"),verifyLogin(()=>{$.log("æ¸²æŸ“æ•°æ®è¡¨"),renderTable([$("#ASIN").val(),...findAllAsin()])})})}));break;default:sendResponse({type:"error",info:"è¯·é€‰æ‹©æ­£ç¡®çš„ç±»å‹"})}}));